<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸŽµ Spelling Bee</title>

<style>
*{margin:0;padding:0;box-sizing:border-box}

body{
  font-family:'Segoe UI',Tahoma,Verdana,sans-serif;
  background:linear-gradient(135deg,#667eea,#764ba2);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px;
}

.container{
  background:#fff;
  border-radius:20px;
  box-shadow:0 20px 60px rgba(0,0,0,.3);
  padding:40px;
  max-width:800px;
  width:100%;
}

h1{
  text-align:center;
  color:#667eea;
  margin-bottom:25px;
}

.filter-section,.player-section{
  background:#f8f9fa;
  border-radius:12px;
  padding:20px;
  margin-bottom:20px;
}

label{font-weight:600;display:block;margin-bottom:6px}

input,textarea{
  width:100%;
  padding:10px;
  border:2px solid #ddd;
  border-radius:6px;
}

textarea{min-height:70px}

.filter-row{display:flex;gap:10px;margin-bottom:15px}

.checkbox-group{display:flex;align-items:center;gap:10px;margin-top:10px}

.button-group{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:10px;
  margin:20px 0;
}

button{
  padding:12px;
  border:none;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
  color:#fff;
}

.btn-primary{background:#667eea}
.btn-success{background:#28a745}
.btn-danger{background:#dc3545}

.song-title{font-size:2.2em;text-align:center;margin-bottom:15px}
.song-emoji{font-size:4.5em;text-align:center;margin-bottom:15px}
.hidden{display:none}

audio{
  width:100%;
  max-width:450px;
  display:block;
  margin:0 auto;
}

.message{
  padding:12px;
  border-radius:8px;
  margin:10px 0;
  text-align:center;
}

.info{background:#d1ecf1;color:#0c5460}
.success{background:#d4edda;color:#155724}
.warning{background:#fff3cd;color:#856404}

.stats{
  display:flex;
  justify-content:space-around;
  background:#e9ecef;
  border-radius:10px;
  padding:15px;
}

.stat-number{
  font-size:1.6em;
  font-weight:bold;
  color:#667eea;
}
</style>
</head>

<body>
<div class="container">

<h1>ðŸŽµ Spelling Bee</h1>

<!-- FILTERS -->
<div class="filter-section" id="filterSection">
  <label>Letter Range</label>
  <div class="filter-row">
    <input type="number" id="rangeFrom" value="1">
    <input type="number" id="rangeTo" value="15">
  </div>

  <label>Exact Words</label>
  <textarea id="specificWords"></textarea>

  <div class="button-group">
    <button class="btn-primary" onclick="applyFilters()">Load Words</button>
  </div>
</div>

<div class="checkbox-group">
  <input type="checkbox" id="hideTitle" onchange="toggleSpellingMode()">
  <label for="hideTitle">Spelling Mode</label>
</div>

<div id="messageContainer"></div>

<!-- PLAYER -->
<div id="playerSection" class="player-section hidden">
  <div id="wordDisplay">
    <div id="emoji" class="song-emoji hidden">ðŸ˜Š</div>
    <div id="wordText" class="song-title"></div>
  </div>
  <audio id="audioPlayer" controls></audio>
</div>

<div class="button-group">
  <button class="btn-success" onclick="playNextWord()">Next</button>
  <button class="btn-danger" onclick="resetGame()">Reset</button>
</div>

<div class="stats">
  <div><div id="totalWords" class="stat-number">0</div>Total</div>
  <div><div id="playedCount" class="stat-number">0</div>Played</div>
  <div><div id="remainingWords" class="stat-number">0</div>Remaining</div>
</div>

</div>

<script>
const filterSection = document.getElementById("filterSection");
const rangeFrom = document.getElementById("rangeFrom");
const rangeTo = document.getElementById("rangeTo");
const specificWords = document.getElementById("specificWords");
const playerSection = document.getElementById("playerSection");
const wordText = document.getElementById("wordText");
const emoji = document.getElementById("emoji");
const audioPlayer = document.getElementById("audioPlayer");
const messageContainer = document.getElementById("messageContainer");
const totalWords = document.getElementById("totalWords");
const playedCount = document.getElementById("playedCount");
const remainingWords = document.getElementById("remainingWords");
const hideTitle = document.getElementById("hideTitle");

let allWords = [];
let filteredWords = [];
let playedWords = [];
let currentWord = null;
let revealed = true;

/* LOAD WORDS */
async function loadWordList(){
  try{
    const res = await fetch("Words/words.csv");
    const text = await res.text();
    allWords = [...new Set(
      text.split(/[,\n\r]+/)
          .map(w => w.trim().toLowerCase())
          .filter(w => w)
    )];
    showMessage(`âœ… ${allWords.length} words loaded`, "success");
  }catch{
    showMessage("âŒ could not load words.csv", "warning");
  }
}

/* APPLY FILTERS */
function applyFilters(){
  const min = parseInt(rangeFrom.value) || 1;
  const max = parseInt(rangeTo.value) || 99;

  const exactList = specificWords.value
    ? specificWords.value.split(/[,\n\r]+/).map(w => w.trim().toLowerCase())
    : [];

  let candidates = exactList.length
    ? allWords.filter(w => exactList.includes(w))
    : allWords;

  filteredWords = candidates.filter(w => w.length >= min && w.length <= max);

  if (!filteredWords.length) {
    showMessage("âš ï¸ no words match the filters", "warning");
    return;
  }

  filterSection.classList.add("hidden"); // âœ… hide inputs
  playerSection.classList.remove("hidden");

  playedWords = [];
  playNextWord();
  updateStats();
}

/* NEXT WORD */
function playNextWord(){
  const remaining = filteredWords.filter(w => !playedWords.includes(w));
  if (!remaining.length) {
    showMessage("ðŸŽ‰ all words played", "info");
    return;
  }

  currentWord = remaining[Math.floor(Math.random() * remaining.length)];
  playedWords.push(currentWord);
  revealed = !hideTitle.checked;
  renderWord();
  updateStats();
}

/* RENDER */
function renderWord(){
  wordText.textContent = currentWord;
  wordText.classList.toggle("hidden", !revealed);
  emoji.classList.toggle("hidden", revealed);

  audioPlayer.innerHTML = "";
  const src = document.createElement("source");
  src.src = `Words/${currentWord}.mp3`;
  src.type = "audio/mpeg";
  audioPlayer.appendChild(src);
  audioPlayer.load();
}

/* SPELLING MODE */
function toggleSpellingMode(){
  if (!currentWord) return;
  revealed = !hideTitle.checked;
  wordText.classList.toggle("hidden", !revealed);
  emoji.classList.toggle("hidden", revealed);
}

/* RESET */
function resetGame(){
  filteredWords = [];
  playedWords = [];
  currentWord = null;

  filterSection.classList.remove("hidden"); // âœ… show inputs again
  playerSection.classList.add("hidden");
  audioPlayer.innerHTML = "";

  updateStats();
  showMessage("ðŸ”„ game reset", "info");
}

/* STATS */
function updateStats(){
  totalWords.textContent = filteredWords.length;
  playedCount.textContent = playedWords.length;
  remainingWords.textContent = Math.max(0, filteredWords.length - playedWords.length);
}

/* MESSAGE */
function showMessage(msg, type){
  messageContainer.innerHTML = `<div class="message ${type}">${msg}</div>`;
}

document.addEventListener("DOMContentLoaded", loadWordList);
</script>

</body>
</html>
